{"EDITOR_STATE":{"allProjectFiles":{"d797e4d3-03c0-42b6-9827-50088b7c4e92":{"id":"d797e4d3-03c0-42b6-9827-50088b7c4e92","parent":null,"name":"test","type":"DIRECTORY","isDirectory":true,"children":["646be645-218f-46e1-8274-8aecc8518f41","ba91d398-e5d3-451a-bb54-6977b7e079c2","353b2eb1-5968-4f8d-9c2a-c500abaa7cfd"],"isRemovable":false,"filePath":"test"},"646be645-218f-46e1-8274-8aecc8518f41":{"id":"646be645-218f-46e1-8274-8aecc8518f41","parent":"d797e4d3-03c0-42b6-9827-50088b7c4e92","name":"lambda.js","type":"LAMBDA_FILE","isDirectory":false,"children":[],"isRemovable":true,"filePath":"test/lambda.js","code":"let AWS = require('aws-sdk');\n// let firebase = require('firebase');\nlet google = require('googleapis').google;\nconst storage = google.storage('v1');\nlet _auth = require('./Authorizer');\nconst pubsub = google.pubsub('v1');\n// let SL_XML = require('slappforge-sdk-xml');\n// const xPathEvaluator = new SL_XML();\nexports.handler = function (event, context, callback) {\n\nlet config = {\n            apiKey: \"AIzaSyDMF17Pu7_5gLRYX_Ff_dbA8Ak5_RONIQA\",\n            authDomain: \"testusercreate-89b32.firebaseapp.com\",\n            databaseURL: \"https://testusercreate-89b32.firebaseio.com\",\n            storageBucket: \"testusercreate-89b32.appspot.com\"\n        };\n\n        if (!firebase.apps.length) {\n            firebase.initializeApp(config);\n        }\n\n        //TODO configure proper authentication\n        firebase.auth().signInWithEmailAndPassword('andun@adroitlogic.com', 'Andun!12345').catch(error => {\n            console.log(error);\n        });\n        // Get a reference to the database service\n        this.database = firebase.database();\n\n\n\n\tpubsub.projects.topics.subscriptions.list({\n\t\ttopic: `projects/${process.env.GCLOUD_PROJECT_ID}/topics/incoming`,\n\t\tpageSize: 10\n\t})\n\t\t.then(response => {\n\t\t\tconsole.log(response.data);  // successful response\n\t\t\t/*\n\t\t\tresponse.data = {\n\t\t\t\t\"subscriptions\": [\n\t\t\t\t\t\"projects/<project>/subscriptions/<subscription-1>\",\n\t\t\t\t\t\"projects/<project>/subscriptions/<subscription-2>\",\n\t\t\t\t\t...\n\t\t\t\t]\n\t\t\t}\n\t\t\t*/\n\t\t})\n\t\t.catch(err => {\n\t\t\tconsole.log(err, err.stack); // an error occurred\n\t\t});\n\tstorage.objects.list({\n\t\tbucket: 'staging.testgcpsigma.appspot.com',\n\t\tmaxResults: 10,\n\t\tprefix: ''\n\t})\n\t\t.then(response => {\n\t\t\tconsole.log(response.data);           // successful response\n\t\t\t/*\n\t\n\t\t\tWARNING: response.data.items will be missing altogether (instead of being empty) if there are no matches!  \n\t\n\t\t\tresponse.data = {\n\t\t\t\t\"kind\": \"storage#objects\",\n\t\t\t\t\"items\": [\n\t\t\t\t\t{\n\t\t\t\t\t\t\"kind\": \"storage#object\",\n\t\t\t\t\t\t\"id\": \"<bucket>/<object>/<timestamp>\",\n\t\t\t\t\t\t\"selfLink\": \"https://www.googleapis.com/storage/v1/b/<bucket>/o/<object>\",\n\t\t\t\t\t\t\"name\": \"<object>\",\n\t\t\t\t\t\t\"bucket\": \"<bucket>\",\n\t\t\t\t\t\t\"contentType\": \"<content-type>\",\n\t\t\t\t\t\t\"timeCreated\": \"<yyyy-MM-ddTHH:mm:ss.###Z>\",\n\t\t\t\t\t\t\"updated\": \"<yyyy-MM-ddTHH:mm:ss.###Z>\",\n\t\t\t\t\t\t\"size\": \"<bytes>\",\n\t\t\t\t\t\t\"md5Hash\": \"<hash>\",\n\t\t\t\t\t\t\"metadata\": {\n\t\t\t\t\t\t\t\"<key1>\": \"<val1>\",\n\t\t\t\t\t\t\t\"<key2>\": \"<val2>\"\n\t\t\t\t\t\t},\n\t\t\t\t\t\t\"crc32c\": \"<crc>\",\n\t\t\t\t\t\t\"etag\": \"<etag>\"\n\t\t\t\t\t\t// , ...\n\t\t\t\t\t}\n\t\t\t\t\t// , ...\n\t\t\t\t]\n\t\t\t}\n\t\t\t*/\n\t\t})\n\t\t.catch(err => {\n\t\t\tconsole.log(err, err.stack); // an error occurred\n\t\t});\n\n\n\n\tcallback(null, 'Successfully executed');\n}","triggers":[],"config":{"memory":128,"timeout":60,"runtime":"nodejs8.10"},"version":2,"syncVersion":34,"testCases":{"af11b258-10ce-4560-a136-b6de52c7b994":{"id":"af11b258-10ce-4560-a136-b6de52c7b994","name":"Unnamed event","functionId":"646be645-218f-46e1-8274-8aecc8518f41","event":"{\n    \"key1\": \"value1\",\n    \"key2\": \"value2\",\n    \"key3\": \"value3\"\n}"}},"references":["ba91d398-e5d3-451a-bb54-6977b7e079c2"]},"ba91d398-e5d3-451a-bb54-6977b7e079c2":{"id":"ba91d398-e5d3-451a-bb54-6977b7e079c2","parent":"d797e4d3-03c0-42b6-9827-50088b7c4e92","name":"Authorizer.js","type":"JS_FILE","isDirectory":false,"children":[],"isRemovable":true,"filePath":"test/Authorizer.js","code":"const google = require(\"googleapis\").google;\n\nconst key = JSON.parse(process.env.GCLOUD_SERVICE_TOKEN);\nconst jwtClient = new google.auth.JWT({\n    email: key.client_email,\n    key: key.private_key,\n    scopes: [\"https://www.googleapis.com/auth/cloud-platform\"]\n});\ngoogle.options({auth: jwtClient, project: process.env.GCLOUD_PROJECT_ID});","triggers":[],"version":null,"syncVersion":2,"references":[]},"353b2eb1-5968-4f8d-9c2a-c500abaa7cfd":{"id":"353b2eb1-5968-4f8d-9c2a-c500abaa7cfd","parent":"d797e4d3-03c0-42b6-9827-50088b7c4e92","name":"test2.js","type":"LAMBDA_FILE","isDirectory":false,"children":[],"isRemovable":true,"filePath":"test/test2.js","code":"let AWS = require('aws-sdk');\nexports.handler = function(event, context, callback) {\n\n\n\tcallback(null,'Successfully executed');\n}","triggers":[],"config":{"memory":128,"timeout":60,"runtime":"nodejs8.10"},"version":1,"testCases":{"327e702a-1526-446d-b931-148a75abb8ee":{"id":"327e702a-1526-446d-b931-148a75abb8ee","name":"Unnamed event","functionId":"353b2eb1-5968-4f8d-9c2a-c500abaa7cfd","event":"{\n    \"key1\": \"value1\",\n    \"key2\": \"value2\",\n    \"key3\": \"value3\"\n}"}},"references":[]}},"rootNode":"d797e4d3-03c0-42b6-9827-50088b7c4e92","openFiles":["646be645-218f-46e1-8274-8aecc8518f41","353b2eb1-5968-4f8d-9c2a-c500abaa7cfd"],"currentFileId":"646be645-218f-46e1-8274-8aecc8518f41","resources":{"pubsubincoming":{"name":"pubsubincoming","type":"pubsub","config":{"mode":1,"topic":{"region":"us-east-1","name":"incoming","subscriptions":[]}},"globallyEditable":false},"gcsstagingtestgcpsigmaappspotcom":{"name":"gcsstagingtestgcpsigmaappspotcom","type":"storage","config":{"mode":1,"bucket":{"region":"us-east-1","name":"staging.testgcpsigma.appspot.com"}},"globallyEditable":false}},"envVariables":[{"lambdaId":"all","varKey":"SIGMA_AWS_ACC_ID","varValue":null,"shouldPersist":false,"editable":false,"isEditable":false},{"lambdaId":"all","varKey":"GCLOUD_SERVICE_TOKEN","varValue":null,"shouldPersist":false,"editable":true,"isEditable":true},{"lambdaId":"all","varKey":"GCLOUD_PROJECT_ID","varValue":null,"shouldPersist":false,"editable":true,"isEditable":true}],"packageJSON":{"dependencies":{"aws-sdk":{"name":"aws-sdk","version":"2.176.0","notRemovable":true},"slappforge-sdk-xml":{"name":"slappforge-sdk-xml","version":"0.0.4","notRemovable":false},"googleapis":{"name":"googleapis","version":"29.0.0","notRemovable":false}}},"lambdaId":"646be645-218f-46e1-8274-8aecc8518f41","additionalFiles":[]},"PROJECT_META":{"projectName":"test","projectDescription":"","projectVersion":"1.0.0","projectRegion":"us-east-1","repoName":"test","repoUrl":"https://github.com/TestAndunR/test","lastSave":1529299171716}}